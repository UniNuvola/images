name: Rebuild Images

on:
  push:
    branches: [ "main" ]

jobs:

  build:
    strategy:
      matrix:
        dir: [unihub, unihubsingle, base, base/conda, base/conda/pytorch, base/conda/pytorch-gpu, base/engineering]

    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v4

    - name: ğŸ›  Build Docker image
      run: cd ${{ matrix.dir}} && make build

    - name: ğŸš€ Push Docker image
      run: cd ${{ matrix.dir}} && make push

    - name: ğŸ”– Tag Docker image
      run: cd ${{ matrix.dir}} && make tag
